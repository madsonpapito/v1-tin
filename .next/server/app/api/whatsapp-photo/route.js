(()=>{var e={};e.id=851,e.ids=[851],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6487:()=>{},8034:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>A,routeModule:()=>c,serverHooks:()=>g,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>h});var r={};s.r(r),s.d(r,{OPTIONS:()=>u,POST:()=>l});var o=s(6559),a=s(8088),n=s(7719),i=s(2190);let p=new Map;async function l(e){let t=process.env.RAPIDAPI_KEY;if(!t)return console.error("CRITICAL ERROR: RAPIDAPI_KEY not found in environment variables!"),i.NextResponse.json({success:!1,error:"Server configuration error"},{status:500});let s={success:!0,result:"https://i.postimg.cc/gcNd6QBM/img1.jpg",is_photo_private:!0};try{let r,{phone:o,countryCode:a}=await e.json();if(!o)return i.NextResponse.json({success:!1,error:"Phone number is required"},{status:400,headers:{"Access-Control-Allow-Origin":"*"}});let n=o.replace(/\D/g,""),l=(a?.replace(/\D/g,"")||"")+n,u=p.get(l);if(u&&Date.now()-u.timestamp<3e5)return console.log("[v0] Returning cached WhatsApp photo"),i.NextResponse.json({success:!0,result:u.result,is_photo_private:!1},{status:200,headers:{"Access-Control-Allow-Origin":"*"}});let c=`https://whatsapp-data1.p.rapidapi.com/number/${l}?base64=false&telegram=false&google=false`,d=await fetch(c,{method:"GET",headers:{"X-RapidAPI-Key":t,"X-RapidAPI-Host":"whatsapp-data1.p.rapidapi.com","Content-Type":"application/json"},signal:AbortSignal.timeout?.(1e4)});if(console.log("[v0] API Response status:",d.status),429===d.status)return console.log("[v0] Rate limit exceeded, returning fallback"),i.NextResponse.json(s,{status:200,headers:{"Access-Control-Allow-Origin":"*"}});if(!d.ok)return console.error("[v0] Erro ao buscar foto:",d.status),i.NextResponse.json(s,{status:200,headers:{"Access-Control-Allow-Origin":"*"}});let h=await d.text();console.log("[v0] API Response body:",h);try{let e=JSON.parse(h);r=e.profilePic||e.url||e.result||e.photo_url||e.picture_url}catch{r=h.trim()}if(!r||!r.startsWith("https://"))return console.log("[v0] Invalid or empty response, returning fallback"),i.NextResponse.json(s,{status:200,headers:{"Access-Control-Allow-Origin":"*"}});if(p.set(l,{result:r.trim(),timestamp:Date.now()}),p.size>100){let e=Array.from(p.entries()).sort((e,t)=>e[1].timestamp-t[1].timestamp)[0][0];p.delete(e)}return i.NextResponse.json({success:!0,result:r.trim(),is_photo_private:!1},{status:200,headers:{"Access-Control-Allow-Origin":"*"}})}catch(e){return console.error("[v0] Erro na requisi\xe7\xe3o:",e),i.NextResponse.json(s,{status:200,headers:{"Access-Control-Allow-Origin":"*"}})}}async function u(){return new i.NextResponse(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}let c=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/whatsapp-photo/route",pathname:"/api/whatsapp-photo",filename:"route",bundlePath:"app/api/whatsapp-photo/route"},resolvedPagePath:"C:\\Users\\madso\\insta-zap-tinder4-main (infidelityfind)\\app\\api\\whatsapp-photo\\route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:d,workUnitAsyncStorage:h,serverHooks:g}=c;function A(){return(0,n.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:h})}},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,580],()=>s(8034));module.exports=r})();